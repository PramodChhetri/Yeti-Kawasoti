import{q as B,W as Q,r as c,j as e,Y as se,a as K,d as ae}from"./app-HoDmrXNN.js";import{T as ne,a as te}from"./toaster-C-HwiJUl.js";import{I as o}from"./InputError-TOSMNCfi.js";import{B as y}from"./button-BJi7Ukxl.js";import{C as M,a as P,b as R,d as C}from"./card-DJOBn3Fy.js";import{I as p}from"./input-CiGtSvJf.js";import{L as t}from"./label-CL0pq-nz.js";import{S as j,a as g,b as f,c as b,d as l}from"./select-CZrVjgA_.js";import{S as le}from"./SingleImageUploader-djD4YNpL.js";import{t as T}from"./use-toast-CIr2tFUS.js";import{D as H,a as X,b as $,c as Z,d as ee,e as re}from"./dialog-CErlIxQH.js";import"./index-CuHBRXKR.js";import"./index-D_DgHOsp.js";import"./index-CZNwChqj.js";import"./x-hw2QYuFl.js";import"./createLucideIcon-B5c7f2k6.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-CFlD9-z1.js";import"./index-DZm7ZyEy.js";import"./index-DmpELkTC.js";import"./check-DBLKpwDX.js";import"./index-Ddbn_Yk1.js";const ie=()=>{var m;const r=B().props.packages,{data:n,setData:i,errors:a,post:v,processing:u,clearErrors:N}=Q({name:"",phone:"",occupation:"",gender:"",marital_status:"",date_of_birth:new Date(new Date().setFullYear(new Date().getFullYear()-20)).toISOString().split("T")[0],address:"",preferred_time:"",payment_proof:"",membership_package_id:r[0].id,months:1,photo:null,emergency_person_name:"",emergency_person_phone:""}),[_,w]=c.useState(0),[S,D]=c.useState(0),[h,V]=c.useState(0),[O,I]=c.useState(0),[q,L]=c.useState(0),[G,U]=c.useState(0),Y=new URLSearchParams(window.location.search),[J,A]=c.useState(Y.get("form")==="register"),W=()=>{const s=r.find(d=>d.id===n.membership_package_id);if(s){const d=Number(s.admission_amount)||0,x=Number(s.monthly_amount)||0,F=x*n.months,E=d+F;let k=0;n.months===3?k=Number(s.discount_quarterly)||0:n.months===6?k=Number(s.discount_half_yearly)||0:n.months===12&&(k=Number(s.discount_yearly)||0),w(d),D(x),V(F),I(E),L(k),U(E-k)}};c.useEffect(()=>{W()},[n.membership_package_id,n.months]);const z=s=>{s.preventDefault(),N(),v("/member/store/apply",{onSuccess:()=>{A(!1),T({description:"Membership registration application submitted, pending admin approval...",duration:5e3})}})};return e.jsxs(H,{open:J,onOpenChange:A,children:[e.jsxs(X,{children:[e.jsx(y,{className:"hidden md:block w-full",color:"primary",type:"submit",disabled:u,children:"Register Membership"}),e.jsx(y,{className:"w-full md:hidden",size:"sm",color:"primary",type:"submit",disabled:u,children:"Register Membership"})]}),e.jsxs($,{className:"max-w-7xl w-[97%] max-h-[97vh] overflow-auto rounded",children:[e.jsx(Z,{children:e.jsx(ee,{children:"Register a Membership"})}),e.jsx("div",{className:"w-full mx-auto space-y-6",children:e.jsx("form",{onSubmit:z,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6 xl:col-span-7 2xl:col-span-8 space-y-6",children:[e.jsxs(M,{children:[e.jsx(P,{children:e.jsx(R,{className:"text-lg",children:"Member Information"})}),e.jsxs(C,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-32",children:[e.jsx(le,{onImageUpload:s=>i("photo",s),className:"aspect-square px-2 w-full",label:"Upload Member Photo"}),e.jsx(o,{message:a.photo,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"name",children:"Name"}),e.jsx(p,{id:"name",value:n.name,onChange:s=>{const d=s.target.value.toLowerCase().replace(/\b\w/g,x=>x.toUpperCase());i("name",d)},placeholder:"Enter member's name",required:!0}),e.jsx(o,{message:a.name,className:"mt-2"}),e.jsx(t,{htmlFor:"address",children:"Address"}),e.jsx(p,{id:"address",value:n.address,onChange:s=>i("address",s.target.value),placeholder:"Enter address",required:!0}),e.jsx(o,{message:a.address,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"phone",children:"Phone"}),e.jsx(p,{id:"phone",value:n.phone,onChange:s=>i("phone",s.target.value),placeholder:"Enter phone number",required:!0,maxLength:10,minLength:10}),e.jsx(o,{message:a.phone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"occupation",children:"Occupation"}),e.jsxs(j,{defaultValue:n.occupation,onValueChange:s=>i("occupation",s),children:[e.jsx(g,{id:"occupation",children:e.jsx(f,{placeholder:"Select occupation"})}),e.jsxs(b,{children:[e.jsx(l,{value:"private-job",children:"Private Job"}),e.jsx(l,{value:"government-job",children:"Government Job"}),e.jsx(l,{value:"business",children:"Business"}),e.jsx(l,{value:"student",children:"Student"}),e.jsx(l,{value:"housewife",children:"House Wife"}),e.jsx(l,{value:"other",children:"Other"})]})]}),e.jsx(o,{message:a.occupation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Gender"}),e.jsxs(j,{defaultValue:n.gender,onValueChange:s=>i("gender",s),children:[e.jsx(g,{id:"gender",children:e.jsx(f,{placeholder:"Select gender"})}),e.jsxs(b,{children:[e.jsx(l,{value:"male",children:"Male"}),e.jsx(l,{value:"female",children:"Female"})]})]}),e.jsx(o,{message:a.gender,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Marital Status"}),e.jsxs(j,{defaultValue:n.marital_status,onValueChange:s=>i("marital_status",s),children:[e.jsx(g,{id:"marital_status",children:e.jsx(f,{placeholder:"Select marital status"})}),e.jsxs(b,{children:[e.jsx(l,{value:"single",children:"Single"}),e.jsx(l,{value:"married",children:"Married"})]})]}),e.jsx(o,{message:a.marital_status,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(p,{id:"date_of_birth",type:"date",value:n.date_of_birth,onChange:s=>i("date_of_birth",s.target.value),required:!0}),e.jsx(o,{message:a.date_of_birth,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"preferred_time",children:"Preferred Shift"}),e.jsxs(j,{onValueChange:s=>i("preferred_time",s),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Select preferred shift"})}),e.jsxs(b,{children:[e.jsx(l,{value:"Morning",children:"Morning"}),e.jsx(l,{value:"Day",children:"Day"}),e.jsx(l,{value:"Evening",children:"Evening"})]})]}),e.jsx(o,{message:a.preferred_time,className:"mt-2"})]})]})]})]}),e.jsxs(M,{children:[e.jsx(P,{children:e.jsx(R,{className:"text-lg",children:"Membership and Payment Details"})}),e.jsxs(C,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"membership_package",children:"Membership Package"}),e.jsxs(j,{defaultValue:n.membership_package_id.toString(),onValueChange:s=>i("membership_package_id",Number(s)),children:[e.jsx(g,{id:"membership_package",children:e.jsx(f,{placeholder:"Select membership package"})}),e.jsx(b,{children:r.map(s=>e.jsx(l,{value:s.id.toString(),children:s.package_name},s.id))})]}),e.jsx(o,{message:a.membership_package_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"months",children:"Initial Registration Months"}),e.jsxs(j,{defaultValue:n.months.toString(),onValueChange:s=>i("months",Number(s)),children:[e.jsx(g,{id:"months",children:e.jsx(f,{placeholder:"Select membership months"})}),e.jsxs(b,{children:[e.jsx(l,{value:"1",children:"1 Month"}),e.jsx(l,{value:"3",children:"3 Months"}),e.jsx(l,{value:"6",children:"6 Months"}),e.jsx(l,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:a.months,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"payment_proof",children:"Payment Proof"}),e.jsx(p,{type:"file",accept:"image/*",onChange:s=>{i("payment_proof",s.target.files?s.target.files[0]:"")}}),e.jsx(o,{message:a.payment_proof})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 xl:col-span-5 2xl:col-span-4 space-y-6",children:[e.jsxs(M,{children:[e.jsx(P,{children:e.jsx(R,{className:"text-lg",children:"Emergency Information"})}),e.jsxs(C,{className:"gap-2 flex flex-col flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"emergency_person_name",children:"Person Name"}),e.jsx(p,{id:"emergency_person_name",value:n.emergency_person_name,onChange:s=>{const d=s.target.value.toLowerCase().replace(/\b\w/g,x=>x.toUpperCase());i("emergency_person_name",d)},placeholder:"Enter emergency contact person name",required:!0}),e.jsx(o,{message:a.emergency_person_name,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"emergency_person_phone",children:"Phone"}),e.jsx(p,{id:"emergency_person_phone",value:n.emergency_person_phone,onChange:s=>i("emergency_person_phone",s.target.value),placeholder:"Enter emergency contact phone number",required:!0}),e.jsx(o,{message:a.emergency_person_phone,className:"mt-2"})]})]})]}),e.jsxs(M,{children:[e.jsx(P,{children:e.jsx(R,{className:"text-lg",children:"Pricing and Payment"})}),e.jsxs(C,{children:[e.jsx("div",{className:"text-start mb-3",children:e.jsx("strong",{children:(m=r.find(s=>s.id===n.membership_package_id))==null?void 0:m.package_name})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Admission Amount"}),e.jsxs("span",{children:["Rs ",_]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Monthly Amount"}),e.jsxs("span",{children:["Rs ",S]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Total Months"}),e.jsxs("span",{children:[n.months," Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",h]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Gross Package Amount"}),e.jsxs("span",{children:["Rs ",O]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Package Discount"}),e.jsxs("span",{children:["- Rs ",q]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("strong",{className:"flex justify-between",children:[e.jsx(t,{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",G]})]}),e.jsx(y,{type:"submit",disabled:u,className:"w-full mt-3",children:u?"Processing...":"Apply for registration"})]})]})]})]})})})]})]})},ce=ie,oe=({member:r,open:n,onClose:i})=>{const{data:a,setData:v,reset:u,errors:N,post:_,processing:w,clearErrors:S}=Q({selected_months:1,payment_proof:null}),[D,h]=c.useState(0),[V,O]=c.useState(0),[I,q]=c.useState(0),[L,G]=c.useState(0),[U,Y]=c.useState(0),[J,A]=c.useState(""),W=m=>{const s=new Date(r.payment_expiry_date);return new Date(s.setMonth(s.getMonth()+m)).toISOString().split("T")[0]};c.useEffect(()=>{const m=Number(r.membership_package.monthly_amount)||0,s=m*a.selected_months;let d=0;a.selected_months===3?d=Number(r.membership_package.discount_quarterly)||0:a.selected_months===6?d=Number(r.membership_package.discount_half_yearly)||0:a.selected_months===12&&(d=Number(r.membership_package.discount_yearly)||0);const x=s,F=x-d;h(m),O(s),q(x),G(d),Y(Math.max(F,0));const E=W(a.selected_months);A(E)},[a.selected_months]);const z=m=>{m.preventDefault(),S(),_(route("renewal.public.store",r.id),{onSuccess:()=>{T({description:"Membership renewal submitted, pending admin approval..."}),i(),u()}})};return e.jsx(H,{open:n,onOpenChange:i,children:e.jsxs($,{className:"max-w-4xl w-[95vw] mx-auto rounded-lg p-6 shadow-lg overflow-auto max-h-[95vh]",children:[e.jsxs(Z,{children:[e.jsx(ee,{className:"text-xl font-semibold",children:"Membership Renewal"}),e.jsxs(re,{className:"text-sm",children:["Renew membership package of ",e.jsx("strong",{children:r.name}),"."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs(M,{children:[e.jsx(P,{children:e.jsx(R,{className:"text-lg font-semibold",children:"Renewal Summary"})}),e.jsxs(C,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Expiry Date"}),e.jsx("strong",{children:r.payment_expiry_date})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Monthly Fees"}),e.jsxs("span",{children:["Rs ",D]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",V]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Gross Amount"}),e.jsxs("span",{children:["Rs ",I]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["- Rs ",L]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",U]})]})]})]}),e.jsxs(M,{children:[e.jsx(P,{className:"pb-0"}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 bg-muted p-3 rounded-lg",children:[e.jsx("div",{className:"",children:e.jsx("img",{className:"size-[40px] rounded-full object-cover",src:r.photo,alt:r.name})}),e.jsxs("div",{className:"grow flex flex-col",children:[e.jsx("span",{className:"font-semibold font-lg",children:r.name}),e.jsx("small",{className:"font-xs",children:r.phone})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Renewal Period (in months)"}),e.jsxs(j,{value:a.selected_months.toString(),onValueChange:m=>v("selected_months",Number(m)),children:[e.jsx(g,{id:"months",children:e.jsx(f,{placeholder:"Select duration"})}),e.jsxs(b,{children:[e.jsx(l,{value:"1",children:"1 Month"}),e.jsx(l,{value:"3",children:"3 Months"}),e.jsx(l,{value:"6",children:"6 Months"}),e.jsx(l,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:N.selected_months})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Payment Proof (Optional)"}),e.jsx(p,{type:"file",onChange:m=>v("payment_proof",m.target.files?m.target.files[0]:null)}),e.jsx(o,{message:N.payment_proof})]}),e.jsx(y,{type:"submit",disabled:w,children:w?"Processing...":"Confirm Renewal"})]})]})]})]})]})})},de=oe;function Ee(){B();const{props:r}=B(),[n,i]=c.useState(""),[a,v]=c.useState(null),u=new URLSearchParams(window.location.search),[N,_]=c.useState(!1),[w,S]=c.useState(u.get("form")==="renew"),D=async()=>{try{const h=await ae.get(`/get-renewal-form/${n}`);h.data.member?(v(h.data.member),S(!1),_(!0)):T({description:"Member not found or no active membership"})}catch{T({description:"Error fetching member data"})}};return e.jsxs(ne,{attribute:"class",defaultTheme:"dark",enableSystem:!0,disableTransitionOnChange:!0,children:[e.jsxs("div",{className:"w-full h-screen bg-no-repeat bg-cover relative",style:{backgroundImage:"url('gym-bg.jpg')"},children:[e.jsx(se,{title:`Welcome to ${r.env.gymName}`}),e.jsx("div",{className:"absolute w-full min-h-full bg-black/60 text-white"}),e.jsxs("div",{className:"relative container min-h-full flex flex-col",children:[e.jsxs("div",{className:"py-7 flex justify-between items-center",children:[e.jsx(K,{href:"/",className:"flex items-center py-3 px-5 w-fit",children:e.jsx("span",{className:"text-xl sm:text-2xl text-white font-semibold",children:r.env.gymName})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(K,{href:"/login",className:"text-sm text-gray-200 hover:underline",children:"Go to Admin Area"})})]}),e.jsx("div",{className:"grow flex items-center justify-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl text-center text-white font-extrabold uppercase",children:["Welcome to ",r.env.gymName]}),e.jsx("h3",{className:"text-white/75 text-center capitalize md:text-lg lg:text-xl font-semibold",children:"Your Fitness Journey Starts Here. Let's Achieve Your Goals Together."}),e.jsxs("div",{className:"flex gap-2 mx-auto justify-center",children:[e.jsx(ce,{})," ",e.jsxs(H,{open:w,onOpenChange:S,children:[e.jsxs(X,{children:[e.jsx(y,{className:"md:hidden",size:"sm",children:"Renew Membership"}),e.jsx(y,{className:"hidden md:block",children:"Renew Membership"})]}),e.jsxs($,{className:"space-y-1",children:[e.jsx("h2",{className:"font-bold",children:"Enter Phone Number to Renew"}),e.jsx(p,{type:"number",className:"flex-grow",onChange:h=>i(h.target.value),placeholder:"Phone number"}),e.jsx("div",{className:"text-end",children:e.jsx(y,{className:"me-auto",onClick:D,children:"Submit Renewal Request"})})]})]})]})]})})]})]}),e.jsx(te,{}),a&&e.jsx(de,{member:a,open:N,onClose:()=>_(!1)})]})}export{Ee as default};
