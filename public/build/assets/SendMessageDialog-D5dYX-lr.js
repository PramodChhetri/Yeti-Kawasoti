import{W as P,r as m,j as t}from"./app-DxhgH9la.js";import{B as M}from"./button-CQRnvolg.js";import{D as S,b as T,c as b,d as L}from"./dialog-BxChAz8L.js";import{T as N}from"./textarea-DQcQfo8L.js";import"./index-CDna1s6C.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-4JGS_wby.js";import"./index-mZgcqd2l.js";import"./index-CzHYO1du.js";import"./index-CirN_iVP.js";import"./x-D4R6_HQS.js";import"./createLucideIcon-BCR1lBT3.js";function q({member:c,open:h,onClose:g}){const{post:d,data:s,setData:p,processing:i}=P({message:"",contacts:[c.phone]}),[u,x]=m.useState(1),[f,j]=m.useState(160),y=e=>{let n=0;for(let a=0;a<e.length;a++){const l=e.charCodeAt(a);n+=l>65535?4:2}return n},D=e=>{const a=y(e)/2,l=e.match(/[^\u0000-\u007F]/)!==null;let r,o;l?a<=70?(r=70,o=1):(o=Math.ceil(a/67),r=o*67):a<=160?(r=160,o=1):(o=Math.ceil(a/153),r=o*153),x(o),j(r),p("message",e)};function v(e){if(e.preventDefault(),!s.message||s.message.trim()===""){alert("Message cannot be empty.");return}if(!s.contacts||s.contacts.length===0||s.contacts.some(n=>!C(n))){alert("Please provide at least one valid contact.");return}console.log(s.message),console.log(s.contacts),!i&&d("/send-message",{onSuccess:()=>{g()}})}const C=e=>/^[0-9]{10,15}$/.test(e);return t.jsx(S,{open:h,onOpenChange:g,children:t.jsxs(T,{className:"max-w-md",children:[t.jsx(b,{children:t.jsxs(L,{children:["Send Message to ",c.name,"..."]})}),t.jsxs("form",{onSubmit:v,className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx(N,{value:s.message,onChange:e=>D(e.target.value),placeholder:"Type your message here..."}),t.jsxs("div",{className:"text-sm text-muted-foreground mt-2 flex justify-between",children:[t.jsxs("span",{children:["Total Pages: ",u]}),t.jsxs("span",{children:[s.message.length," / ",f]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx(M,{type:"submit",disabled:i,children:i?"Processing...":"Send Message"})})]})]})})}export{q as SendMessageDialog};
