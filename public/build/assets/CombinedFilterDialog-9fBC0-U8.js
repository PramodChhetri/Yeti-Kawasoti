import{q as H,r as o,j as e,y as I}from"./app-CeHawWK7.js";import{I as x}from"./input-iG9gLFRb.js";import{B as y}from"./button-CBFDvSSe.js";import{D as J,a as q,b as z,c as W,d as $}from"./dialog-vdBOxT0G.js";import{L as n}from"./label-DZHSVrJR.js";import{S as m}from"./segmented-control-BJ3PsD5-.js";import{S as P,a as V,b as L,c as U,d as c}from"./select-CrO88sMk.js";import{T as Q,a as X,b as S,c as N}from"./tabs-BAfxlyZP.js";import{F as Y}from"./filter-DSXKKHjN.js";import"./utils-CRrpu23W.js";import"./index-Clynsdhc.js";import"./index-Bb4qSo10.js";import"./index-DmAnl5gc.js";import"./index-B_ku7PSA.js";import"./index-DD1TA57H.js";import"./index-C9wzw3Ty.js";import"./x-CcTwlrmH.js";import"./createLucideIcon-T09ZsU69.js";import"./index-JWIwkwlr.js";import"./index-BBHitacn.js";import"./check-U2lRsC70.js";import"./index-CRFetRKe.js";function Z(D){const R=new URLSearchParams(D.split("?")[1]),j={},i=(h,p,d)=>{p.reduce((u,s,r)=>(r===p.length-1?u[s]=d:u[s]=u[s]||{},u[s]),h)};for(const[h,p]of R.entries())if(h.startsWith("filter[")){const d=h.match(/filter\[(.+?)\]/);if(d&&d[1]){const s=d[1].split(/\[|\]/).filter(Boolean);i(j,s,p)}}return j}function De({packages:D,recipientType:R}){var O,w,T,k,G,E;const j=H().url,i=Z(j),[h,p]=o.useState(!1),[d,u]=o.useState("members"),[s,r]=o.useState({membership_package_id:i.membership_package_id||"all",gender:i.gender||"all",status:i.status||"all",joiningDateRange:{start:((O=i.start_date)==null?void 0:O.start)||"",end:((w=i.start_date)==null?void 0:w.end)||""},expiryDateRange:{start:((T=i.payment_expiry_date)==null?void 0:T.start)||"",end:((k=i.payment_expiry_date)==null?void 0:k.end)||""}}),[t,g]=o.useState({position:i.position||"all",gender:i.gender||"all",status:i.status||"all",joiningDateRange:{start:((G=i.joining_date)==null?void 0:G.start)||"",end:((E=i.joining_date)==null?void 0:E.end)||""}}),[C,f]=o.useState(s.gender),[F,v]=o.useState(s.status),[A,b]=o.useState(t.gender),[M,_]=o.useState(t.status);o.useEffect(()=>{f(s.gender),v(s.status),b(t.gender),_(t.status)},[s.gender,s.status,t.gender,t.status]);const B=()=>{const a=new URLSearchParams;a.append("recipient_type",R),a.append("auto_load","false"),(d==="members"||d==="both")&&(a.append("filter[member_filter]","true"),s.membership_package_id!=="all"&&a.append("filter[membership_package_id]",s.membership_package_id),s.gender!=="all"&&a.append("filter[gender]",s.gender),s.status!=="all"&&a.append("filter[status]",s.status),s.joiningDateRange.start&&a.append("filter[start_date][start]",s.joiningDateRange.start),s.joiningDateRange.end&&a.append("filter[start_date][end]",s.joiningDateRange.end),s.expiryDateRange.start&&a.append("filter[payment_expiry_date][start]",s.expiryDateRange.start),s.expiryDateRange.end&&a.append("filter[payment_expiry_date][end]",s.expiryDateRange.end)),(d==="officials"||d==="both")&&(a.append("official_filter_enabled","true"),t.position!=="all"&&a.append("filter[position]",t.position),t.gender!=="all"&&a.append("filter[gender]",t.gender),t.status!=="all"&&a.append("filter[status]",t.status),t.joiningDateRange.start&&a.append("filter[joining_date][start]",t.joiningDateRange.start),t.joiningDateRange.end&&a.append("filter[joining_date][end]",t.joiningDateRange.end)),console.log("Applying combined filters with params:",Object.fromEntries(a.entries()));const l=`/messenging?${a.toString()}`;I.visit(l),p(!1)},K=()=>{r({membership_package_id:"all",gender:"all",status:"all",joiningDateRange:{start:"",end:""},expiryDateRange:{start:"",end:""}}),g({position:"all",gender:"all",status:"all",joiningDateRange:{start:"",end:""}}),f("all"),v("all"),b("all"),_("all")};return e.jsxs(J,{open:h,onOpenChange:p,children:[e.jsx(q,{asChild:!0,children:e.jsxs(y,{variant:"secondary",className:"border",children:[e.jsx(Y,{size:14})," Â  Apply Filters"]})}),e.jsxs(z,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(W,{children:e.jsx($,{children:"Filter Recipients"})}),e.jsxs(Q,{defaultValue:"members",value:d,onValueChange:u,className:"mt-4",children:[e.jsxs(X,{className:"grid grid-cols-3 mb-4",children:[e.jsx(S,{value:"members",children:"Members"}),e.jsx(S,{value:"officials",children:"Officials"}),e.jsx(S,{value:"both",children:"Apply Both"})]}),e.jsxs(N,{value:"members",className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Member Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsx(m,{items:[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"All",value:"all"}],value:C,onChange:a=>{f(a),r(l=>({...l,gender:a}))}})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"membership-package",children:"Membership Package"}),e.jsxs(P,{value:s.membership_package_id,onValueChange:a=>r(l=>({...l,membership_package_id:a})),children:[e.jsx(V,{children:e.jsx(L,{placeholder:"Select membership package"})}),e.jsxs(U,{children:[e.jsx(c,{value:"all",children:"All"}),D.map(a=>e.jsx(c,{value:a.id.toString(),children:a.package_name},a.id))]})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Joining Date Range"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{type:"date",name:"joining_start_date",value:s.joiningDateRange.start,onChange:a=>{r(l=>({...l,joiningDateRange:{...l.joiningDateRange,start:a.target.value}}))},className:"w-full"}),e.jsx("span",{children:"-"}),e.jsx(x,{type:"date",name:"joining_end_date",value:s.joiningDateRange.end,onChange:a=>r(l=>({...l,joiningDateRange:{...l.joiningDateRange,end:a.target.value}})),className:"w-full"})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Expiry Date Range"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{type:"date",name:"expiry_start_date",value:s.expiryDateRange.start,onChange:a=>{r(l=>({...l,expiryDateRange:{...l.expiryDateRange,start:a.target.value}}))},className:"w-full"}),e.jsx("span",{children:"-"}),e.jsx(x,{type:"date",name:"expiry_end_date",value:s.expiryDateRange.end,onChange:a=>r(l=>({...l,expiryDateRange:{...l.expiryDateRange,end:a.target.value}})),className:"w-full"})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Status"}),e.jsx(m,{items:[{label:"Active",value:"active"},{label:"Expired",value:"expired"},{label:"Unapproved",value:"unapproved"},{label:"All",value:"all"}],value:F,onChange:a=>{v(a),r(l=>({...l,status:a}))}})]})]})]}),e.jsxs(N,{value:"officials",className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Official Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsx(m,{items:[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"All",value:"all"}],value:A,onChange:a=>{b(a),g(l=>({...l,gender:a}))}})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"position",children:"Position"}),e.jsxs(P,{value:t.position,onValueChange:a=>{g(l=>({...l,position:a}))},children:[e.jsx(V,{children:e.jsx(L,{placeholder:"Select position"})}),e.jsxs(U,{children:[e.jsx(c,{value:"all",children:"All"}),e.jsx(c,{value:"Owner",children:"Owner"}),e.jsx(c,{value:"Manager",children:"Manager"}),e.jsx(c,{value:"Trainer",children:"Trainer"}),e.jsx(c,{value:"Reception",children:"Reception"}),e.jsx(c,{value:"Guard",children:"Guard"}),e.jsx(c,{value:"House-Keeping",children:"House Keeping"}),e.jsx(c,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Joining Date Range"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{type:"date",name:"official_joining_start_date",value:t.joiningDateRange.start,onChange:a=>{g(l=>({...l,joiningDateRange:{...l.joiningDateRange,start:a.target.value}}))},className:"w-full"}),e.jsx("span",{children:"-"}),e.jsx(x,{type:"date",name:"official_joining_end_date",value:t.joiningDateRange.end,onChange:a=>g(l=>({...l,joiningDateRange:{...l.joiningDateRange,end:a.target.value}})),className:"w-full"})]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(n,{children:"Status"}),e.jsx(m,{items:[{label:"Active",value:"active"},{label:"Disabled",value:"disabled"},{label:"All",value:"all"}],value:M,onChange:a=>{_(a),g(l=>({...l,status:a}))}})]})]})]}),e.jsxs(N,{value:"both",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Member Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsx(m,{items:[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"All",value:"all"}],value:C,onChange:a=>{f(a),r(l=>({...l,gender:a}))}})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Status"}),e.jsx(m,{items:[{label:"Active",value:"active"},{label:"All",value:"all"}],value:F,onChange:a=>{v(a),r(l=>({...l,status:a}))}})]})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Official Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsx(m,{items:[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"All",value:"all"}],value:A,onChange:a=>{b(a),g(l=>({...l,gender:a}))}})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Status"}),e.jsx(m,{items:[{label:"Active",value:"active"},{label:"All",value:"all"}],value:M,onChange:a=>{_(a),g(l=>({...l,status:a}))}})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-4",children:[e.jsx(y,{variant:"outline",onClick:K,children:"Clear All"}),e.jsx(y,{onClick:B,children:"Apply Filters"})]})]})]})}export{De as default};
