import{j as e,W as P}from"./app-HoDmrXNN.js";import{I as l}from"./InputError-TOSMNCfi.js";import{B as N}from"./button-BJi7Ukxl.js";import{C as m,a as x,b as h,c as p,d as R}from"./card-DJOBn3Fy.js";import{D as f,b as y,c as I,d as B,e as H,a as V}from"./dialog-CErlIxQH.js";import{I as j}from"./input-CiGtSvJf.js";import{L as o}from"./label-CL0pq-nz.js";import{S as M,a as O,b as L,c as k,d as u}from"./select-CZrVjgA_.js";import{T as q,a as z,b as g,c as d,d as F,e as i}from"./table-BBGnmZM7.js";import{T as U}from"./textarea-BcKiGzl-.js";import{t as v}from"./use-toast-CIr2tFUS.js";import{f as W}from"./format-CE4V3joc.js";import"./index-CFlD9-z1.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-Ddbn_Yk1.js";import"./index-CuHBRXKR.js";import"./index-D_DgHOsp.js";import"./index-DmpELkTC.js";import"./x-hw2QYuFl.js";import"./createLucideIcon-B5c7f2k6.js";import"./index-CZNwChqj.js";import"./index-DZm7ZyEy.js";import"./check-DBLKpwDX.js";function ue({refetch:T,official:n,open:_,onClose:C}){console.log(n);const c=Object.values((n==null?void 0:n.transactions)||[]),D=()=>{const{data:s,setData:a,errors:t,post:w,processing:b,reset:S}=P({official_id:n.id,transaction_type:"",description:"",amount:"",transaction_date:"",voucher_number:""}),A=async r=>{if(r.preventDefault(),!s.transaction_type||!s.amount||!s.transaction_date){v({description:"Please fill all required fields!"});return}w("/official-transactions/store",{onSuccess:()=>{v({description:"Transaction created successfully!"}),S(),T()},onError:E=>{console.error("Submission error:",E),v({description:"Failed to create Transaction."})}})};return e.jsxs(f,{children:[e.jsx(V,{asChild:!0,children:e.jsx(N,{variant:"default",className:"w-fit ms-auto",children:"Add Transaction"})}),e.jsx(y,{className:"max-w-[500px]",children:e.jsxs("form",{onSubmit:A,className:"space-y-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium leading-none",children:"Add Transaction"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enter the transaction details for ",e.jsx("strong",{children:n.name})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Transaction Type"}),e.jsxs(M,{value:s.transaction_type,onValueChange:r=>a("transaction_type",r),children:[e.jsx(O,{children:e.jsx(L,{placeholder:"Select transaction type"})}),e.jsxs(k,{children:[e.jsx(u,{value:"advance_payment",children:"Advance Payment"}),e.jsx(u,{value:"salary_payment",children:"Salary Payment"}),e.jsx(u,{value:"bonus",children:"Bonus"})]})]}),e.jsx(l,{message:t.transaction_type})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Amount"}),e.jsx(j,{type:"number",placeholder:"Enter amount",value:s.amount,onChange:r=>a("amount",r.target.value)}),e.jsx(l,{message:t.amount})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Transaction Date"}),e.jsx(j,{type:"date",value:s.transaction_date,onChange:r=>a("transaction_date",r.target.value)}),e.jsx(l,{message:t.transaction_date})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Voucher Number (optional)"}),e.jsx(j,{placeholder:"Enter voucher number (if applicable)",onChange:r=>a("voucher_number",r.target.value)}),e.jsx(l,{message:t.voucher_number})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 mt-4",children:e.jsxs("div",{children:[e.jsx(o,{children:"Description"}),e.jsx(U,{placeholder:"Enter Description of the transaction",value:s.description,onChange:r=>a("description",r.target.value)}),e.jsx(l,{message:t.description})]})}),e.jsx(N,{type:"submit",className:"mt-4 w-full",disabled:b,children:b?"Processing...":"Create Transaction"})]})]})})]})};return e.jsx(f,{open:_,onOpenChange:C,children:e.jsxs(y,{className:"max-w-[1600px] w-[95vw] max-h-[99vh] overflow-auto",children:[e.jsxs(I,{children:[e.jsx(B,{children:"Official Transactions"}),e.jsx(H,{children:"Efficiently analyze the payments of a official."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(m,{className:"bg-blue-500",children:e.jsxs(x,{children:[e.jsx(h,{className:"text-white",children:c.length}),e.jsx(p,{className:"text-white/80",children:"Total Transactions"})]})}),e.jsx(m,{className:"bg-fuchsia-600",children:e.jsxs(x,{children:[e.jsxs(h,{className:"text-white",children:["Rs ",c.reduce((s,a)=>s+Number(a.amount),0)]}),e.jsx(p,{className:"text-white/80",children:"Total Paid Amount"})]})}),e.jsx(m,{className:"bg-green-500",children:e.jsxs(x,{children:[e.jsxs(h,{className:"text-white",children:["Rs"," ",c.filter(s=>s.transaction_type==="advance_payment").reduce((s,a)=>s+Number(a.amount),0)]}),e.jsx(p,{className:"text-white/80",children:"Total Advanced Salary"})]})})]}),e.jsx("div",{className:"w-fit ms-auto space-x-2",children:e.jsx(D,{})}),e.jsx(m,{children:e.jsx(R,{children:e.jsxs(q,{className:"text-center",children:[e.jsx(z,{children:e.jsxs(g,{className:"hover:bg-card",children:[e.jsx(d,{className:"text-center",children:"Transaction Date"}),e.jsx(d,{className:"text-center",children:"Paid Amount"}),e.jsx(d,{className:"text-center",children:"Voucher No."}),e.jsx(d,{className:"text-center",children:"Transaction Type"}),e.jsx(d,{className:"text-center",children:"Remarks"})]})}),e.jsx(F,{children:c.length===0?e.jsx(g,{children:e.jsx(i,{colSpan:5,className:"text-center text-muted-foreground",children:"No transactions available."})}):c.map((s,a)=>e.jsxs(g,{className:"hover:bg-muted/15",children:[e.jsx(i,{children:W(new Date(s.transaction_date),"dd MMM yyyy")}),e.jsxs(i,{children:["Rs ",Number(s.amount)]}),e.jsx(i,{children:s.voucher_number||"-"}),e.jsx(i,{children:s.transaction_type.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}),e.jsx(i,{children:s.description||"-"})]},s.id||`transaction-${a}`))})]})})})]})})}export{ue as StaffAccountsDialog};
