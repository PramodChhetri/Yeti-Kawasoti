import{r as C,j as e,Y as $,y as w,W as A,d as q}from"./app-DxhgH9la.js";import{A as z}from"./AuthenticatedLayout-Daqh-ZAm.js";import{C as O,a as W,b as Y,c as Z,d as j}from"./card-JPYiSOfV.js";import{T as b,a as f,b as c,c as r,d as g,e as n}from"./table-1forINFq.js";import{T as G,a as J,b as p}from"./tabs-D9kQVB7V.js";import{B as v}from"./button-CQRnvolg.js";import{L as K}from"./loader-9WjFfT2C.js";import Q from"./TransactionDialog-BDSkCpiq.js";import{B as x}from"./badge-DTXEnE2r.js";import{P as E,a as k,b as P}from"./popover-CB_DOt37.js";import{L}from"./label-BCYFEXFM.js";import{I as S}from"./input-DTs6kzBN.js";import{t as X}from"./use-toast-Tc-_Q_S1.js";import{F as ee}from"./filter-C9xw_lrm.js";import{c as B}from"./createLucideIcon-BCR1lBT3.js";import{f as R}from"./format-CE4V3joc.js";import"./GlobalLayout-Bq7hwQH4.js";import"./toaster-bZriELgZ.js";import"./index-mZgcqd2l.js";import"./index-CzHYO1du.js";import"./index-CF3a9R0E.js";import"./x-D4R6_HQS.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./sheet-Cf9Z4Dtw.js";import"./index-4JGS_wby.js";import"./index-CirN_iVP.js";import"./dropdown-menu-Dg02MNjQ.js";import"./index-CXOfu3wE.js";import"./check-eedJZ6Dw.js";import"./index-CDna1s6C.js";import"./InputError-B6HEij25.js";import"./dialog-BxChAz8L.js";import"./select-Kd40EoFx.js";import"./textarea-DQcQfo8L.js";/**
 * @license lucide-react v0.368.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=B("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.368.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=B("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function Oe({auth:a,data:s,activeTab:i,creditedMembers:d}){const[t,M]=C.useState(i||"registrations"),[F,D]=C.useState(!0),U=l=>{D(!0),M(l),w.get(route("transactions.index"),{tab:l},{onFinish:()=>D(!1)})};C.useEffect(()=>{D(!1)},[]);const V=l=>{l&&(D(!0),w.visit(l,{onFinish:()=>D(!1),preserveState:!0,preserveScroll:!0}))},I=()=>{const l=new URLSearchParams(window.location.search),N=l.get("filter[startDate]")||"",T=l.get("filter[endDate]")||"",{data:o,setData:m,errors:y}=A({startDate:N,endDate:T}),_=u=>{u.preventDefault();let h=new URLSearchParams(window.location.search);o.startDate?h.set("filter[startDate]",o.startDate):h.delete("filter[startDate]"),o.endDate?h.set("filter[endDate]",o.endDate):h.delete("filter[endDate]"),w.visit(route("transactions.index")+"?"+h.toString())};return C.useEffect(()=>{o.startDate||m("startDate",N),o.endDate||m("endDate",T)},[m,N,T]),e.jsxs(E,{children:[e.jsx(k,{asChild:!0,children:e.jsxs(v,{variant:"secondary",className:"flex items-center",children:[e.jsx(ee,{className:"size-4 me-2"})," Filter"]})}),e.jsx(P,{className:"w-fit",children:e.jsxs("form",{className:"flex gap-2 items-end",onSubmit:_,children:[e.jsxs("div",{children:[e.jsx(L,{children:"Start Date"}),e.jsx(S,{type:"date",value:o.startDate||"",onChange:u=>m("startDate",u.target.value)})]}),e.jsxs("div",{children:[e.jsx(L,{children:"End Date"}),e.jsx(S,{type:"date",value:o.endDate||"",onChange:u=>m("endDate",u.target.value)})]}),e.jsx("div",{children:e.jsx(v,{type:"submit",className:"w-full",children:"Filter"})})]})})]})},H=()=>{const{data:l,setData:N,post:T,processing:o}=A({startDate:"",endDate:""}),m=async y=>{y.preventDefault();try{const _=await q.post("/export-transactions",{startDate:l.startDate,endDate:l.endDate},{responseType:"blob"}),u=window.URL.createObjectURL(new Blob([_.data])),h=document.createElement("a");h.href=u,h.setAttribute("download",`income-expense-statement-${l.startDate}-to-${l.endDate}.xlsx`),document.body.appendChild(h),h.click(),h.remove()}catch(_){console.error("Error exporting data:",_)}};return e.jsxs(E,{children:[e.jsx(k,{asChild:!0,children:e.jsxs(v,{variant:"secondary",className:"flex items-center",children:[e.jsx(se,{className:"size-4 me-2"})," Export"]})}),e.jsx(P,{className:"w-fit",children:e.jsxs("form",{className:"flex gap-2 items-end",onSubmit:m,children:[e.jsxs("div",{children:[e.jsx(L,{children:"Start Date"}),e.jsx(S,{type:"date",value:l.startDate||"",onChange:y=>N("startDate",y.target.value)})]}),e.jsxs("div",{children:[e.jsx(L,{children:"End Date"}),e.jsx(S,{type:"date",value:l.endDate||"",onChange:y=>N("endDate",y.target.value)})]}),e.jsx("div",{children:e.jsx(v,{type:"submit",className:"w-full",children:"Export"})})]})})]})};return e.jsxs(z,{user:a.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Transactions"}),children:[e.jsx($,{title:"Transactions"}),e.jsxs(O,{children:[e.jsxs(W,{className:"flex justify-between flex-row",children:[e.jsxs("div",{children:[e.jsx(Y,{children:"Transactions"}),e.jsx(Z,{children:"View and manage gym transactions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(H,{}),e.jsx(I,{}),e.jsx(Q,{})]})]}),e.jsx(j,{children:e.jsxs(G,{value:t,onValueChange:U,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(J,{children:[e.jsx(p,{value:"registrations",children:"Registrations"}),e.jsx(p,{value:"renewals",children:"Renewals"}),e.jsx(p,{value:"lockers",children:"Lockers"}),e.jsx(p,{value:"miscellaneous",children:"Miscellaneous"}),e.jsx(p,{value:"refunds",children:"Refunds"}),e.jsx(p,{value:"expenses",children:"Expenses"}),e.jsx(p,{value:"credits",children:"Credits"})]}),e.jsxs("span",{children:["showing ",s.data.length," of ",s.total," ","records"]})]}),F?e.jsx("div",{className:"flex justify-center items-center my-10",children:e.jsx(K,{size:"lg"})}):e.jsxs(e.Fragment,{children:[t==="registrations"&&ne(s),t==="renewals"&&ie(s),t==="lockers"&&de(s),t==="miscellaneous"&&te(s),t==="refunds"&&le(s),t==="expenses"&&ae(s),t==="credits"&&ce(s),e.jsx("div",{className:"flex justify-end mt-4 space-x-2",children:s.links.map(l=>e.jsx(v,{onClick:()=>V(l.url),variant:l.active?"default":"ghost",dangerouslySetInnerHTML:{__html:l.label}},l.url))})]})]})})]})]})}function ne(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Membership Package"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Package Amount"}),e.jsx(r,{children:"Extra Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Balance"}),e.jsx(r,{children:"Payment Mode"})]})}),e.jsx(g,{children:a.data.map(s=>{const i=Number(s.net_amount)-Number(s.paid_amount);return e.jsxs(c,{children:[e.jsx(n,{children:R(new Date(s.payment_date),"yyyy-MM-dd")}),e.jsx(n,{children:s.member.name}),e.jsx(n,{children:s.member.membership_package.package_name}),e.jsx(n,{children:e.jsx(x,{className:"text-xs",children:s.bill_number})}),e.jsxs(n,{children:["Rs"," ",Number(s.total_monthly_fees)+Number(s.admission_fees)-Number(s.package_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.extra_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})]}):e.jsx("span",{children:"Rs 0"})}),e.jsx(n,{children:s.payment_mode})]},s.id)})})]})})}function de(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Locker No."}),e.jsx(r,{children:"Duration"}),e.jsx(r,{children:"Bill Number"}),e.jsx(r,{children:"Locker Charge"}),e.jsx(r,{children:"Locker Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Balance"}),e.jsx(r,{children:"Payment Mode"})]})}),e.jsx(g,{children:a.data.map(s=>{var t;const i=Number(s.net_amount)-Number(s.paid_amount),d=s.total_months===1?"1 Month":`${s.total_months} Months`;return e.jsxs(c,{children:[e.jsx(n,{children:new Date(s.payment_date).toLocaleDateString()}),e.jsx(n,{children:((t=s.member)==null?void 0:t.name)||"Unknown"}),e.jsx(n,{children:e.jsx(x,{variant:"outline",className:"text-primary border-primary",children:e.jsx("strong",{children:s.locker_number})})}),e.jsx(n,{children:d})," ",e.jsx(n,{children:e.jsx(x,{children:s.bill_number})}),e.jsxs(n,{children:["Rs ",Number(s.locker_charge)]}),e.jsxs(n,{children:["Rs ",Number(s.locker_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})," "]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})," "]}):e.jsx("span",{children:"Rs 0"})}),e.jsx(n,{children:s.payment_mode})," "]},s.id)})})]})})}function ie(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Membership Package"}),e.jsx(r,{children:"Duration"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Package Amount"}),e.jsx(r,{children:"Extra Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Balance"})]})}),e.jsx(g,{children:a.data.map(s=>{const i=Number(s.monthly_fees)*Number(s.total_months)-Number(s.extra_discount)-Number(s.package_discount)-Number(s.paid_amount),d=s.total_months===1?"1 Month":`${s.total_months} Months`;return e.jsxs(c,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.member.name}),e.jsx(n,{children:s.member.membership_package.package_name}),e.jsx(n,{children:d})," ",e.jsx(n,{children:e.jsx(x,{className:"text-xs",children:s.bill_number})}),e.jsxs(n,{children:["Rs"," ",Number(s.monthly_fees)*Number(s.total_months)-Number(s.package_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.extra_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:s.payment_mode}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})]}):e.jsx("span",{children:"Rs 0"})})]},s.id)})})]})})}function te(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Total"}),e.jsx(r,{children:"Paid"}),e.jsx(r,{children:"Credit"}),e.jsx(r,{children:"Transaction Type"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(g,{children:a.data.map(s=>{var i,d,t;return e.jsxs(c,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.name||((i=s.member)==null?void 0:i.name)}),e.jsxs(n,{children:["Rs ",Number(s.total_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsxs(n,{children:["Rs"," ",s.total_amount-s.paid_amount]}),e.jsx(n,{children:s.transaction_type}),e.jsx(n,{children:e.jsx(x,{children:s.bill_number||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((d=s==null?void 0:s.description)==null?void 0:d.length)>0?s.description.substring(0,50):"",((t=s==null?void 0:s.description)==null?void 0:t.length)>50?"...":""]})]},s.id)})})]})})}function le(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Refund Amount"}),e.jsx(r,{children:"PV No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(g,{children:a.data.map(s=>{var i,d,t;return e.jsxs(c,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:(i=s.member)==null?void 0:i.name}),e.jsxs(n,{children:["Rs ",Number(s.refund_amount)]}),e.jsx(n,{children:e.jsx(x,{children:s.payment_voucher||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((d=s==null?void 0:s.description)==null?void 0:d.length)>0?s.description.substring(0,50):"",((t=s==null?void 0:s.description)==null?void 0:t.length)>50?"...":""]})]},s.id)})})]})})}function ae(a){return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Expense Amount"}),e.jsx(r,{children:"Expense Type"}),e.jsx(r,{children:"PV No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(g,{children:a.data.map(s=>{var i,d;return e.jsxs(c,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.name}),e.jsxs(n,{children:["Rs ",Number(s.expense_amount)]}),e.jsx(n,{children:s.expense_type}),e.jsx(n,{children:e.jsx(x,{children:s.payment_voucher||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((i=s==null?void 0:s.description)==null?void 0:i.length)>0?s.description.substring(0,50):"",((d=s==null?void 0:s.description)==null?void 0:d.length)>50?"...":""]})]},s.id)})})]})})}function ce(a){const s=a.data||[],i=async d=>{try{w.post(route("transactions.send-credit-message",d.id)),X({description:`Message sent to ${d.name} successfully...`})}catch(t){console.error("Error sending credit message:",t)}};return e.jsx(j,{children:e.jsxs(b,{children:[e.jsx(f,{children:e.jsxs(c,{children:[e.jsx(r,{children:"Member Image"}),e.jsx(r,{children:"Membership ID"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Phone"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Credit"}),e.jsx(r,{children:"Message"})]})}),e.jsx(g,{children:s.map(d=>{var t,M;return e.jsxs(c,{children:[e.jsx(n,{children:e.jsx("img",{src:d==null?void 0:d.photo,className:"w-14 h-14 sm:w-10 sm:h-10 object-cover rounded-full border-2 border-primary p-0.5",alt:"Member"})}),e.jsx(n,{children:d==null?void 0:d.id}),e.jsx(n,{children:d==null?void 0:d.name}),e.jsx(n,{children:d==null?void 0:d.phone}),e.jsx(n,{children:((t=d==null?void 0:d.status)==null?void 0:t.toLowerCase())==="active"?e.jsx(x,{className:"bg-green-500 hover:bg-green-600",children:"Active"}):((M=d==null?void 0:d.status)==null?void 0:M.toLowerCase())==="unapproved"?e.jsx(x,{className:"bg-orange-500 hover:bg-orange-600",children:"Unapproved"}):e.jsx(x,{className:"bg-red-500 hover:bg-red-600",children:(d==null?void 0:d.status)||"Unknown"})}),e.jsxs(n,{children:["Rs ",Number(d.credit)]}),e.jsx(n,{children:e.jsx(re,{className:"hover:scale-110",onClick:()=>i(d)})})]},d.id)})})]})})}export{Oe as default};
