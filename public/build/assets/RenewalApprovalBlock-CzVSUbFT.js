import{r as m,W as F,j as e}from"./app-CeHawWK7.js";import{C as N,a as C,b as w,d as R}from"./card-m7sUhe83.js";import{D as T,a as Q,b as L,c as z,d as H,e as O,f as V}from"./dialog-vdBOxT0G.js";import{S as W,a as G,b as J,c as K,d as u}from"./select-CrO88sMk.js";import{I as f}from"./input-iG9gLFRb.js";import{B as D}from"./button-CBFDvSSe.js";import{L as x}from"./label-DZHSVrJR.js";import{I as h}from"./InputError-B_B1jo66.js";import{t as b}from"./use-toast-TciExXPv.js";import{P as U,a as X,b as Y}from"./popover-BfFK9Qtk.js";import{C as Z}from"./circle-check-big-Ctyzl1ia.js";import"./utils-CRrpu23W.js";import"./index-DmAnl5gc.js";import"./index-B_ku7PSA.js";import"./index-DD1TA57H.js";import"./index-C9wzw3Ty.js";import"./x-CcTwlrmH.js";import"./createLucideIcon-T09ZsU69.js";import"./index-JWIwkwlr.js";import"./index-BBHitacn.js";import"./check-U2lRsC70.js";import"./index-Clynsdhc.js";import"./index-Bb4qSo10.js";const _e=({application:l})=>{const g=l.member,p=m.useRef(null),{data:s,setData:a,reset:P,errors:o,post:S,processing:j,clearErrors:q}=F({extra_discount:0,paid_amount:0,bill_number:"",payment_mode:"Cash"}),c=Number(l.months),n=g.membership_package||{},v=Number(n.monthly_amount)||0,y=c*v;let t=0;switch(c){case 3:t=Number(n.discount_quarterly)||0;break;case 6:t=Number(n.discount_half_yearly)||0;break;case 12:t=Number(n.discount_yearly)||0;break;default:t=0}const[d,A]=m.useState(0),i=y-t;m.useEffect(()=>{i&&(a("extra_discount",Math.max(0,s.extra_discount)),a("paid_amount",Math.max(0,s.paid_amount)),A(i-Number(s.extra_discount)))},[s.extra_discount,s.paid_amount]);const E=()=>s.paid_amount>d?"Advance Amount":"Credit Amount",k=()=>s.paid_amount>d?s.paid_amount-d:d-s.paid_amount,M=r=>{if(r.preventDefault(),!j){if(q(),!s.payment_mode||!s.bill_number||s.paid_amount<=0){b({description:"Please fill in all required fields correctly.",variant:"destructive"});return}S(route("public-renewal.confirm",l.id),{onSuccess:()=>{b({description:"Renewal request confirmed successfully."}),_(!1),P()},onError:I=>{console.error(I),b({description:"An error occurred during submission.",variant:"destructive"})}})}},[B,_]=m.useState(!1);return e.jsxs(T,{open:B,onOpenChange:_,children:[e.jsx(Q,{children:e.jsx(D,{size:"icon",variant:"ghost",children:e.jsx(Z,{className:"text-primary"})})}),e.jsxs(L,{className:"max-w-4xl w-[95vw] mx-auto rounded-lg p-6 shadow-lg overflow-auto max-h-[95vh]",children:[e.jsxs(z,{children:[e.jsx(H,{className:"text-xl font-semibold",children:"Confirm Renewal Request"}),e.jsxs(O,{className:"text-sm",children:["Confirm the renewal request for ",e.jsx("strong",{children:g.name}),"."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs(N,{children:[e.jsxs(C,{className:"flex justify-between flex-row",children:[e.jsx(w,{className:"text-lg font-semibold",children:"Pricing Summary"}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsx("a",{href:"javascript:",children:e.jsx("u",{children:"Payment Proof"})})}),e.jsx(Y,{className:"border rounded-md size-[370px]",children:e.jsx("img",{src:l.payment_proof_path,alt:"Payment Proof",className:"object-contain w-full h-full border"})})]})})]}),e.jsxs(R,{children:[e.jsx("b",{children:n.package_name||"N/A"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Requested Renewal Period"}),e.jsxs("strong",{children:[c," ",c===1?"Month":"Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Monthly Fees"}),e.jsxs("strong",{children:["Rs ",v]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Calculated Monthly Fees"}),e.jsxs("strong",{children:["Rs ",y]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Package Discount"}),e.jsxs("strong",{children:["- Rs ",t]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Actual Receivable"}),e.jsxs("b",{className:"cursor-pointer",onClick:()=>{p.current&&(a("paid_amount",i),p.current.value=i.toString())},children:["Rs ",i]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Received Amount"}),e.jsxs("span",{children:["Rs ",s.paid_amount]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Extra Discount"}),e.jsxs("span",{children:["- Rs ",s.extra_discount]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:E()}),e.jsxs("span",{children:["Rs ",k()]})]})]})]}),e.jsxs(N,{children:[e.jsx(C,{children:e.jsx(w,{className:"text-lg",children:"Payment Information"})}),e.jsx(R,{className:"space-y-4",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Payment Method"}),e.jsxs(W,{required:!0,value:s.payment_mode,onValueChange:r=>a("payment_mode",r),children:[e.jsx(G,{id:"payment-method",children:e.jsx(J,{placeholder:"Select payment method"})}),e.jsxs(K,{children:[e.jsx(u,{value:"Cash",children:"Cash"}),e.jsx(u,{value:"QR",children:"QR"}),e.jsx(u,{value:"Cash + QR",children:"Cash + QR"}),e.jsx(u,{value:"Cheque",children:"Cheque"})]})]}),e.jsx(h,{message:o.payment_mode})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Bill Number"}),e.jsx(f,{required:!0,type:"text",placeholder:"Enter bill number",onChange:r=>a("bill_number",r.target.value)}),e.jsx(h,{message:o.bill_number})]}),e.jsxs("div",{className:"flex gap-x-1 gap-y-2 flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(x,{children:"Extra Discount"}),e.jsx(f,{type:"number",placeholder:"Enter extra discount",onChange:r=>a("extra_discount",Math.max(0,Number(r.target.value)))}),e.jsx(h,{message:o.extra_discount})]}),e.jsxs("div",{className:"grow",children:[e.jsx(x,{children:"Received Amount"}),e.jsx(f,{required:!0,type:"number",placeholder:"Enter amount",ref:p,onChange:r=>a("paid_amount",Math.max(0,Number(r.target.value)))}),e.jsx(h,{message:o.paid_amount})]})]}),e.jsx(D,{disabled:j,children:j?"Processing...":"Confirm Renewal"})]})})]})]}),e.jsx(V,{})]})]})};export{_e as default};
